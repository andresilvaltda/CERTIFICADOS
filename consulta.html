<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Consulta de Certificado</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f5f5f5; padding: 20px; }
    .container { max-width: 600px; margin: auto; background: white; padding: 30px; border-radius: 10px; box-shadow: 0 0 10px #ccc; text-align: center; }
    .resultado { margin-top: 20px; padding: 1rem; border-radius: 5px; }
    .valido { background: #d4edda; color: #155724; }
    .invalido { background: #f8d7da; color: #721c24; }
    input, button { padding: 10px; margin: 10px 0; width: 100%; font-size: 1rem; }
  </style>
</head>
<body>
  <div class="container">
    <h2>Consulta de Certificado</h2>
    <div id="formBusca">
      <input type="text" id="codigo" placeholder="Digite o código do certificado">
      <button onclick="buscar()">Verificar</button>
    </div>
    <div id="resultado" class="resultado"></div>
  </div>

  <script type="module">
    import { db, collection, getDocs } from './firebase-config.js';

    const colRef = collection(db, "certificados");

    async function buscar() {
      const codigo = new URLSearchParams(window.location.search).get("codigo") || document.getElementById("codigo").value.trim();
      const resultado = document.getElementById("resultado");
      let encontrado = false;
      const snapshot = await getDocs(colRef);
      snapshot.forEach(doc => {
        const cert = doc.data();
        if (cert.codigo === codigo) {
          resultado.innerHTML = `
            <div class='valido'>
              ✅ Certificado Válido<br>
              <b>Nome:</b> ${cert.nome}<br>
              <b>Curso:</b> ${cert.curso}<br>
              <b>Data:</b> ${cert.data}<br>
              <b>Empresa:</b> ${cert.empresa}
            </div>`;
          encontrado = true;
        }
      });
      if (!encontrado) {
        resultado.innerHTML = "<div class='invalido'>❌ Certificado não encontrado.</div>";
      }
    }

    window.onload = buscar;
  </script>
</body>
</html>
